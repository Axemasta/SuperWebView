parameters:
  jdkTestFolder: $(XA.Jdk11.Folder)

steps:

- script: build/scripts/xcode-update.sh
  displayName: Force Xcode Update
  env:
    XcodeOverride: $(XcodeOverride)
  condition: ne(variables['XcodeOverride'], '')

- script: ../scripts/xcode-update.sh
  displayName: Force Xcode Update
  env:
    XcodeOverride: $(XcodeOverride)
  condition: ne(variables['XcodeOverride'], '')

- task: UseDotNet@2
  displayName: 'Use global.json SDK'
  inputs:
    packageType: 'sdk'
    useGlobalJson: true

- task: JavaToolInstaller@0
  inputs:
    versionSpec: '11'
    jdkArchitectureOption: 'x64'
    jdkSourceOption: 'PreInstalled'

# https://github.com/xamarin/xamarin-android/issues/5999

- script: echo '##vso[task.setvariable variable=JI_JAVA_HOME]$(JAVA_HOME_11_X64)'
  displayName: set JI_JAVA_HOME

- script: |
    export JI_JAVA_HOME="$JAVA_HOME_11_X64"
  displayName: Set Java Home Path

- script: |
    dotnet tool install --global boots --ignore-failed-sources
    boots --stable Mono
    boots --stable XamarinAndroid
    boots --stable XamariniOS
  displayName: Ensure Latest Xamarin & Mono SDKs